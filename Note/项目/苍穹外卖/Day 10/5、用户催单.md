### 需求分析与设计

![[Pasted image 20240531151108.png]]

![[Pasted image 20240531151129.png]]

![[Pasted image 20240531151147.png|500]]

### 代码开发

在OrderController里新建一个催单方法：

```java
@GetMapping("/reminder/{id}")  
@ApiOperation("客户催单")  
public Result reminder(@PathVariable("id") Long id){  
    orderService.reminder(id);  
    return Result.success();  
}
```

OrderService：

```java
/**  
 * 客户催单  
 * @param id  
 */  
void reminder(Long id);
```

```java
@Override  
public void reminder(Long id) {  
    // 根据id查询订单  
    Orders ordersDB = orderMapper.getById(id);  
  
    // 校验订单是否存在  
    if (ordersDB == null) {  
        throw new OrderBusinessException(MessageConstant.ORDER_STATUS_ERROR);  
    }  
  
    Map map = new HashMap();  
    map.put("type",2); // 1表示来单提醒，2表示客户催单  
    map.put("orderId",id);  
    map.put("content","订单号"+ ordersDB.getNumber());  
    String json = JSON.toJSONString(map);  
  
    // 向浏览器推送消息  
    webSocketServer.sendToAllClient(json);  
}
```

### 测试

![[Pasted image 20240531153738.png|240]]

![[Pasted image 20240531153751.png|425]]